#### 18. Modules in Powershell Part 2

###### Writing Modules

```Show-AdvancedScript.psm1```

```PowerShell
function Show-AdvancedScript
{
    [CmdletBinding( SupportsShouldProcess = $True)]
    param(
    [Parameter()]
    $Global:FilePath
    )

    Write-Verbose "Deleting $FilePath"
    if ($PSCmdlet.ShouldProcess("$FilePath", "Deleting file permanently"))
    {
    Remove-Item $FilePath
    }


}

function Test-FileExistence
{
    Test-Path $FilePath
}

function DoNoNeedToShow
{
    Write-Output "No Need to show this to user"
}

Export-ModuleMember -Function *-*
```

- Import the module

```PowerShell
PS C:\Users\Windows10-32> cd .\Desktop

PS C:\Users\Windows10-32\Desktop> Import-Module .\Show-AdvancedScript.psm1

PS C:\Users\Windows10-32\Desktop> Get-Module

ModuleType Version    Name                                ExportedCommands                                                                   
---------- -------    ----                                ----------------                                                                   
Script     1.0.0.0    ISE                                 {Get-IseSnippet, Import-IseSnippet, New-IseSnippet}                                
Manifest   3.1.0.0    Microsoft.PowerShell.Management     {Add-Computer, Add-Content, Checkpoint-Computer, Clear-Content...}                 
Manifest   3.1.0.0    Microsoft.PowerShell.Utility        {Add-Member, Add-Type, Clear-Variable, Compare-Object...}                          
Script     0.0        Show-AdvancedScript                 {Show-AdvancedScript, Test-FileExistence}                                          



PS C:\Users\Windows10-32\Desktop> 
```

```PowerShell
PS C:\Users\Windows10-32\Desktop> Import-Module .\Show-AdvancedScript.psm1 -Verbose
VERBOSE: Loading module from path 'C:\Users\Windows10-32\Desktop\Show-AdvancedScript.psm1'.
VERBOSE: Importing function 'Show-AdvancedScript'.
VERBOSE: Importing function 'Test-FileExistence'.

PS C:\Users\Windows10-32\Desktop> 
```

- List the functions of a module

```PowerShell
PS C:\Users\Windows10-32\Desktop> Get-Command -Module Show-AdvancedScript

CommandType     Name                                               Version    Source                                                         
-----------     ----                                               -------    ------                                                         
Function        Show-AdvancedScript                                0.0        Show-AdvancedScript                                            
Function        Test-FileExistence                                 0.0        Show-AdvancedScript                                            



PS C:\Users\Windows10-32\Desktop> 
```

- Remove module

```PowerShell
PS C:\Users\Windows10-32\Desktop> Remove-Module Show-AdvancedScript
```

```PowerShell
PS C:\Users\Windows10-32\Desktop> Get-Module

ModuleType Version    Name                                ExportedCommands                                                                   
---------- -------    ----                                ----------------                                                                   
Script     1.0.0.0    ISE                                 {Get-IseSnippet, Import-IseSnippet, New-IseSnippet}                                
Manifest   3.1.0.0    Microsoft.PowerShell.Management     {Add-Computer, Add-Content, Checkpoint-Computer, Clear-Content...}                 
Manifest   3.1.0.0    Microsoft.PowerShell.Utility        {Add-Member, Add-Type, Clear-Variable, Compare-Object...}                          



PS C:\Users\Windows10-32\Desktop> 
```

- Controlling visibility

```PowerShell
PS C:\Users\Windows10-32\Desktop> Remove-Module Show-AdvancedScript
```

```PowerShell
PS C:\Users\Windows10-32\Desktop> Get-Module 

ModuleType Version    Name                                ExportedCommands                                                                   
---------- -------    ----                                ----------------                                                                   
Script     1.0.0.0    ISE                                 {Get-IseSnippet, Import-IseSnippet, New-IseSnippet}                                
Manifest   3.1.0.0    Microsoft.PowerShell.Management     {Add-Computer, Add-Content, Checkpoint-Computer, Clear-Content...}                 
Manifest   3.1.0.0    Microsoft.PowerShell.Utility        {Add-Member, Add-Type, Clear-Variable, Compare-Object...}                          



PS C:\Users\Windows10-32\Desktop>
```

```PowerShell
PS C:\Users\Windows10-32\Desktop> Import-Module .\Show-AdvancedScript.psm1 -Verbose
VERBOSE: Importing function 'Show-AdvancedScript'.
VERBOSE: Importing function 'Test-FileExistence'.

PS C:\Users\Windows10-32\Desktop> 
```