#### 21. Remoting Part 2

###### PowerShell Remoting

- Based on ```WSMAN``` Protocol and uses ```WinRM```    - Needs port ```5985(HTTP)``` and ```5986(HTTPS)```
    - Alternate ports possible- Using PowerShell Remoting    - Trusted Domain (No special requirement)    - WorkGroup [```(WSMan:\localhost\client\trustedhosts)```](https://social.technet.microsoft.com/Forums/windows/en-US/b853e77c-7c9a-4231-a32b-c63727ec5868/access-denied-when-trying-to-set-trusted-hosts-for-psremoting?forum=winserverpowershell)- Running cmdlets which support Remoting

```PowerShell
PS C:\Windows\system32> Start-Service WinRM
```

```PowerShell
PS C:\Windows\system32> Set-ItemProperty -Path HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -Name LocalAccountTokenFilterPolicy -Value 1 -Type DWord
```

```PowerShell
PS C:\Windows\system32> Set-Item WSMan:\localhost\client\trustedhosts -Value *

WinRM Security Configuration.
This command modifies the TrustedHosts list for the WinRM client. The computers in the TrustedHosts list might not be authenticated. The client might send credential information
to these computers. Are you sure that you want to modify this list?
[Y] Yes  [N] No  [S] Suspend  [?] Help (default is "Y"): Y
PS C:\Windows\system32>
```

```PowerShell
PS C:\Windows\system32> Get-Item WSMan:\localhost\client\trustedhosts


   WSManConfig: Microsoft.WSMan.Management\WSMan::localhost\Client

Name                      Value                                                             Type
----                      -----                                                             ----
TrustedHosts              *                                                                 System.String


PS C:\Windows\system32>
```

Invoke-Command -ScriptBlock { $env:COMPUTERNAME } -ComputerName WINDOWS7-64-PC -Credential WINDOWS7-64-PC\Windows7-64