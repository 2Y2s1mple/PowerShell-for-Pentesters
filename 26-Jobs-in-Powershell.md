#### 26. Jobs in Powershell

###### Jobs

- ```Help``` system for ```job```

```PowerShell
PS C:\Users\Administrator> help *job*

Start-Job                         Cmdlet    Microsoft.PowerShell.Core Starts a Windows PowerShell background job.
Get-Job                           Cmdlet    Microsoft.PowerShell.Core Gets Windows PowerShell background jobs that are running in the current session.
Receive-Job                       Cmdlet    Microsoft.PowerShell.Core Gets the results of the Windows PowerShell background jobs in the current session.
Stop-Job                          Cmdlet    Microsoft.PowerShell.Core Stops a Windows PowerShell background job.
Wait-Job                          Cmdlet    Microsoft.PowerShell.Core Suppresses the command prompt until one or all of the Windows PowerShell background jobs running in the session are complete.
Remove-Job                        Cmdlet    Microsoft.PowerShell.Core Deletes a Windows PowerShell background job.
Suspend-Job                       Cmdlet    Microsoft.PowerShell.Core Temporarily stops workflow jobs.
Resume-Job                        Cmdlet    Microsoft.PowerShell.Core Restarts a suspended job
Get-PrintJob                      Function  PrintManagement           ...
Remove-PrintJob                   Function  PrintManagement           ...
Restart-PrintJob                  Function  PrintManagement           ...
Resume-PrintJob                   Function  PrintManagement           ...
Suspend-PrintJob                  Function  PrintManagement           ...
New-JobTrigger                    Cmdlet    PSScheduledJob            New-JobTrigger...
Add-JobTrigger                    Cmdlet    PSScheduledJob            Add-JobTrigger...
Remove-JobTrigger                 Cmdlet    PSScheduledJob            Remove-JobTrigger...
Get-JobTrigger                    Cmdlet    PSScheduledJob            Get-JobTrigger...
Set-JobTrigger                    Cmdlet    PSScheduledJob            Set-JobTrigger...
Enable-JobTrigger                 Cmdlet    PSScheduledJob            Enable-JobTrigger...
Disable-JobTrigger                Cmdlet    PSScheduledJob            Disable-JobTrigger...
New-ScheduledJobOption            Cmdlet    PSScheduledJob            New-ScheduledJobOption...
Get-ScheduledJobOption            Cmdlet    PSScheduledJob            Get-ScheduledJobOption...
Set-ScheduledJobOption            Cmdlet    PSScheduledJob            Set-ScheduledJobOption...
Register-ScheduledJob             Cmdlet    PSScheduledJob            Register-ScheduledJob...
Get-ScheduledJob                  Cmdlet    PSScheduledJob            Get-ScheduledJob...
Set-ScheduledJob                  Cmdlet    PSScheduledJob            Set-ScheduledJob...
Unregister-ScheduledJob           Cmdlet    PSScheduledJob            Unregister-ScheduledJob...
Enable-ScheduledJob               Cmdlet    PSScheduledJob            Enable-ScheduledJob...
Disable-ScheduledJob              Cmdlet    PSScheduledJob            Disable-ScheduledJob...
Get-RDVirtualDesktopCollection... Function  RemoteDesktop             ...
Stop-RDVirtualDesktopCollectio... Function  RemoteDesktop             ...
Get-StorageJob                    Function  Storage                   ...
about_Jobs                        HelpFile                            Provides information about how Windows PowerShell background jobs run a
about_Job_Details                 HelpFile                            Provides details about background jobs on local and remote computers.
about_Remote_Jobs                 HelpFile                            Describes how to run background jobs on remote computers.
about_Scheduled_Jobs              HelpFile                            Describes scheduled jobs and explains how to use and manage
about_Scheduled_Jobs_Advanced     HelpFile                            Explains advanced scheduled job topics, including the file structure
about_Scheduled_Jobs_Basics       HelpFile                            Explains how to create and manage scheduled jobs.
about_Scheduled_Jobs_Troublesh... HelpFile                            Explains how to resolve problems with scheduled jobs

PS C:\Users\Administrator>
```

- ```Commands``` with ```jobs```

```PowerShell
PS C:\Users\Administrator> Get-Command *job*

CommandType     Name                                               ModuleName
-----------     ----                                               ----------
Function        Get-PrintJob                                       PrintManagement
Function        Get-RDVirtualDesktopCollectionJobStatus            RemoteDesktop
Function        Get-StorageJob                                     Storage
Function        Remove-PrintJob                                    PrintManagement
Function        Restart-PrintJob                                   PrintManagement
Function        Resume-PrintJob                                    PrintManagement
Function        Stop-RDVirtualDesktopCollectionJob                 RemoteDesktop
Function        Suspend-PrintJob                                   PrintManagement
Cmdlet          Add-JobTrigger                                     PSScheduledJob
Cmdlet          Disable-JobTrigger                                 PSScheduledJob
Cmdlet          Disable-ScheduledJob                               PSScheduledJob
Cmdlet          Enable-JobTrigger                                  PSScheduledJob
Cmdlet          Enable-ScheduledJob                                PSScheduledJob
Cmdlet          Get-Job                                            Microsoft.PowerShell.Core
Cmdlet          Get-JobTrigger                                     PSScheduledJob
Cmdlet          Get-ScheduledJob                                   PSScheduledJob
Cmdlet          Get-ScheduledJobOption                             PSScheduledJob
Cmdlet          New-JobTrigger                                     PSScheduledJob
Cmdlet          New-ScheduledJobOption                             PSScheduledJob
Cmdlet          Receive-Job                                        Microsoft.PowerShell.Core
Cmdlet          Register-ScheduledJob                              PSScheduledJob
Cmdlet          Remove-Job                                         Microsoft.PowerShell.Core
Cmdlet          Remove-JobTrigger                                  PSScheduledJob
Cmdlet          Resume-Job                                         Microsoft.PowerShell.Core
Cmdlet          Set-JobTrigger                                     PSScheduledJob
Cmdlet          Set-ScheduledJob                                   PSScheduledJob
Cmdlet          Set-ScheduledJobOption                             PSScheduledJob
Cmdlet          Start-Job                                          Microsoft.PowerShell.Core
Cmdlet          Stop-Job                                           Microsoft.PowerShell.Core
Cmdlet          Suspend-Job                                        Microsoft.PowerShell.Core
Cmdlet          Unregister-ScheduledJob                            PSScheduledJob
Cmdlet          Wait-Job                                           Microsoft.PowerShell.Core

PS C:\Users\Administrator>
```

- ```Start``` a ```job```

```PowerShell
PS C:\Users\Administrator> Start-Job -ScriptBlock {whoami}

Id     Name            PSJobTypeName   State         HasMoreData     Location             Command
--     ----            -------------   -----         -----------     --------             -------
2      Job2            BackgroundJob   Running       True            localhost            whoami

PS C:\Users\Administrator>
```

- List all ```jobs```

```PowerShell
PS C:\Users\Administrator> Get-Job

Id     Name            PSJobTypeName   State         HasMoreData     Location             Command
--     ----            -------------   -----         -----------     --------             -------
2      Job2            BackgroundJob   Completed     True            localhost            whoami

PS C:\Users\Administrator>
```

- Receive ```output``` of a ```job``````PowerShell
PS C:\Users\Administrator> Get-Job | Receive-Job
pfpt\administrator
PS C:\Users\Administrator>
```

- Remove ```job```

```PowerShell
PS C:\Users\Administrator> Get-Job | Remove-Jobs
```

```PowerShell
PS C:\Users\Administrator> Get-Job
```

- ```Local job```

```PowerShell
PS C:\Users\Administrator> Start-Job -FilePath .\Desktop\HelloWorld.ps1

Id     Name            PSJobTypeName   State         HasMoreData     Location             Command
--     ----            -------------   -----         -----------     --------             -------
2      Job2            BackgroundJob   Running       True            localhost            "Hello World"


PS C:\Users\Administrator>
```

```PowerShell
PS C:\Users\Administrator> Get-Job -Id 2

Id     Name            PSJobTypeName   State         HasMoreData     Location             Command
--     ----            -------------   -----         -----------     --------             -------
2      Job2            BackgroundJob   Completed     True            localhost            "Hello World"


PS C:\Users\Administrator>
```

```PowerShell
PS C:\Users\Administrator> Get-Job -Id 2 | Receive-Job
Hello World
PS C:\Users\Administrator>
```

- ```Remote job```

```PowerShell
PS C:\Users\Administrator> Get-Command -ParameterName Asjob

CommandType     Name                                               ModuleName
-----------     ----                                               ----------
Cmdlet          Get-WmiObject                                      Microsoft.PowerShell.Management
Cmdlet          Invoke-Command                                     Microsoft.PowerShell.Core
Cmdlet          Invoke-WmiMethod                                   Microsoft.PowerShell.Management
Cmdlet          Remove-WmiObject                                   Microsoft.PowerShell.Management
Cmdlet          Restart-Computer                                   Microsoft.PowerShell.Management
Cmdlet          Set-WmiInstance                                    Microsoft.PowerShell.Management
Cmdlet          Stop-Computer                                      Microsoft.PowerShell.Management
Cmdlet          Test-Connection                                    Microsoft.PowerShell.Management


PS C:\Users\Administrator>
```

```PowerShell
PS C:\Users\Administrator> Invoke-Command -ScriptBlock {ps} -ComputerName WINDOWS-32-PC -Credential WINDOWS-32-PC\windows-32
```

```PowerShell
PS C:\Users\Administrator> Invoke-Command -ScriptBlock {ps} -ComputerName WINDOWS-32-PC -Credential WINDOWS-32-PC\windows-32
```
###### Run jobs in a PSSession